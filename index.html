<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>vplus -  转拽爪 </title>
    <meta name="theme-color" content="#7367f0">
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <style>
        /*  砖专 注爪 拽专 砖  砖 */
        * { box-sizing: border-box; touch-action: manipulation; }
        body { font-family: system-ui, sans-serif; background: linear-gradient(135deg, #f4f7fa 0%, #e8ecf3 100%); padding-bottom: 240px; min-height: 100vh; transition: background 0.3s; margin: 0; }
        .item-card { background: white; border-radius: 25px; padding: 15px; margin-bottom: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03); display: flex; flex-direction: column; transition: transform 0.2s, box-shadow 0.2s; }
        .item-card:active { transform: scale(0.98); }
        .item-number { color: #7367f0; opacity: 0.6; font-size: 0.8em; margin-left: 4px; }
        #searchInput { transition: all 0.3s ease; border: 2px solid transparent; }
        #searchInput:focus { border-color: #7367f0; background: #fff; box-shadow: 0 10px 25px rgba(115, 103, 240, 0.1); outline: none; }
        .bottom-bar { position: fixed; bottom: 0; left: 0; right: 0; background: linear-gradient(135deg, #7367f0 0%, #9055ff 100%); z-index: 1000; padding: 15px 15px 35px 15px; border-radius: 35px 35px 0 0; box-shadow: 0 -10px 25px rgba(0, 0, 0, 0.15); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; }
        .bottom-bar.minimized { transform: translateY(calc(100% - 8px)); }
        .tab-btn { flex: 1; padding: 12px; border-radius: 15px; font-weight: bold; text-align: center; cursor: pointer; transition: 0.2s; background: white; color: #666; border: 1px solid #eee; }
        .tab-active { background: linear-gradient(135deg, #7367f0 0%, #9055ff 100%) !important; color: white !important; box-shadow: 0 4px 12px rgba(115, 103, 240, 0.3); }
        .bottom-circle-btn { width: 48px !important; height: 48px !important; flex-shrink: 0 !important; border-radius: 50% !important; display: flex !important; align-items: center !important; justify-content: center !important; border: 2px solid rgba(255, 255, 255, 0.2) !important; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2) !important; cursor: pointer; transition: transform 0.2s; }
        .bottom-circle-btn:active { transform: scale(0.95); }
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0, 0, 0, 0.75); z-index: 7000; align-items: flex-start; justify-content: center; backdrop-filter: blur(8px); padding-top: 0; }
        .modal-overlay.active { display: flex; }
        .edit-modal { width: 90%; max-width: 400px; background-color: #ffffff !important; border-radius: 0 0 30px 30px; padding: 6px 25px; text-align: center; color: #333; border: 2px solid #eee; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3); max-height: 90vh; overflow-y: auto; }
        .modal-input { width: 100%; padding: 6px; border: 2px solid #f3f4f6; border-radius: 16px; font-size: 16px; text-align: center; outline: none; margin-bottom: 5px; font-weight: bold; background: #f9fafb !important; color: #333; }
        .app-header { background: white; padding: 10px 20px; display: flex; flex-direction: row-reverse; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05); position: sticky; top: 0; z-index: 2000; height: 60px; }
        .category-separator { background: linear-gradient(135deg, #7367f0 0%, #9055ff 100%); color: white; border-radius: 20px; padding: 15px; margin-bottom: 20px; text-align: center; }
        body.dark-mode { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: #e0e0e0; }
        .dark-mode .app-header { background: #16213e; border-bottom: 1px solid #0f3460; }
        .dark-mode .item-card, .dark-mode .bg-white, .dark-mode .stat-card { background-color: #0f3460 !important; border-color: #1a1a2e; color: white; }
        .cloud-btn-connected { background: #dcfce7 !important; color: #15803d !important; border-color: #86efac !important; }
        .cloud-btn-disconnected { background: #f3f4f6; color: #6b7280; border-color: #e5e7eb; }
    </style>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').catch(error => console.log('SW failed:', error));
            });
        }
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithRedirect, GoogleAuthProvider, getRedirectResult, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        try {
            // 转拽: authDomain  转  砖 Firebase  砖 GitHub
            const firebaseConfig = { 
                apiKey: "AIzaSyBqIqxoiwwqeKkjlYJpEiqgCG09PgabwhI", 
                authDomain: "vplus-pro.firebaseapp.com", 
                projectId: "vplus-pro", 
                storageBucket: "vplus-pro.firebasestorage.app", 
                messagingSenderId: "386740827706", 
                appId: "1:386740827706:web:a3c95c895826df4bb26703" 
            };

            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
            const db = getFirestore(app);
            const provider = new GoogleAuthProvider();

            window.firebaseAuth = auth;
            window.firebaseDb = db;
            window.googleProvider = provider;
            window.signInWithRedirect = signInWithRedirect;
            window.getRedirectResult = getRedirectResult;
            window.signOut = signOut;
            window.onAuthStateChanged = onAuthStateChanged;
            window.doc = doc;
            window.setDoc = setDoc;
            window.onSnapshot = onSnapshot;
            window.getDoc = getDoc;

            console.log("Firebase initialized");

            getRedirectResult(auth).then((result) => {
                if (result?.user) {
                    console.log('转专转 爪:', result.user.email);
                }
            }).catch((error) => {
                console.error('砖 -redirect:', error);
                alert('砖转 转专转: ' + error.code);
            });
        } catch (e) {
            console.error("Firebase fail:", e);
        }
    </script>
</head>

<body>
    <div class="app-header no-print">
        <h1 class="font-bold text-2xl" style="direction: ltr;">
            <span style="color: #22c55e !important;">V</span><span class="text-indigo-600">plus</span><span style="font-size: 10px; color: #9055ff; vertical-align: super;">PRO</span>
        </h1>
        <div class="header-controls">
            <div id="cloudBtn" class="cloud-btn-disconnected px-3 py-1 rounded-full text-[10px] font-bold border flex items-center gap-1 cursor-pointer transition-all">
                <span id="cloudSyncText">住专 注</span>
                <div id="cloudIndicator" class="w-2 h-2 bg-gray-400 rounded-full"></div>
            </div>
            <button onclick="openModal('settingsModal')" class="p-2 rounded-full hover:bg-gray-100 gear-btn">
                <svg class="w-7 h-7 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
            </button>
        </div>
    </div>

    <div class="max-w-md mx-auto p-4 no-print">
        <div class="flex gap-3 mb-6">
            <div id="tabLists" onclick="showPage('lists')" class="tab-btn tab-active">专砖 砖</div>
            <div id="tabSummary" onclick="showPage('summary')" class="tab-btn">专砖转 砖</div>
            <div id="tabStats" onclick="showPage('stats')" class="tab-btn"> 住住拽转</div>
        </div>
        <div id="pageLists">
            <div id="itemsContainer"></div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
